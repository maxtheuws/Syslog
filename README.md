Een programma dat de 10 meest recent toegevoegde berichten uit syslog (Links to an external site.) opvraagt en weergeeft in een human-friendly formaat.

Ik ben begonnen met het bekijken wat de opties hiervoor zijn. Eerst ben ik naar de bestanden gaan kijken waar de syslog wordt gelogd. De log files hiervoor hebben de .evtx extensie. Het bestand waar de systeem logs worden weggeschreven heet system.evtx. Om dit bestand uit te lezen via Python kun je python-evtx gebruiken. Dit heb ik geÃ¯nstalleerd via cmd: pip install python-evtx. En ook via de terminal van pycharm. Hierna heb ik een YouTube tutorial gevolgd voor het weergeven van deze log file. Hiermee kon ik de log file weergeven alleen ik wist niet hoe ik het aan kon passen aangezien ik weinig documentatie kon vinden over de package. Ik heb nog verder gezocht om via de logging module het gewenste resultaat te behalen maar kwam hier verder niet meer uit.
Hierna ben ik het gaan proberen via Powershell. Ik weet dat dit niet helemaal de bedoeling is, maar ik heb daar meer kennis van en syslogging leek me ook prima te doen met Powershell. Ik heb het onderstaande script geschreven:
Get-EventLog -LogName System -Newest 10 | Select-Object -Property TimeGenerated, EntryType, Source, Message > C:\Users\Max\CPSC\evtx\log.txt  | type C:\Users\Max\CPSC\evtx\log.txt -Encoding UTF8 

Eerst gebruik ik de Get-EventLog functie om de event log aan te spreken. Hierna specificeer ik welk soort logs ik wil hebben met -LogName System. Om de laatste 10 logs te weergeven gebruik ik -Newest 10. Hierna gebruik ik een pipe om het door te geven. Het volgende gedeelte is om de logs Human Friendly weer te geven. -property selecteert de kolomnamen. Ik heb hier de tijd dat ze aangemaakt zijn, wat voor soort log het is, de oorsprong van de log en het bericht in opgenomen. Dit wordt dan weggeschreven naar een log.txt met de encoding UTF8.
Ik heb ook ingesteld dat het Powershell script om de 10 minuten wordt uitgevoerd via de taakplanner. Het kan natuurlijk ook handmatig uitgevoerd worden.
